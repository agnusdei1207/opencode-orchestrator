<div align="center">
  <img src="assets/logo.png" alt="Logo" width="200" />
</div>

# OpenCode Orchestrator ğŸ¯

> **Enterprise-Grade Autonomous Multi-Agent Plugin for [OpenCode](https://opencode.ai)**

[![MIT License](https://img.shields.io/badge/license-MIT-blue.svg)](LICENSE)
[![npm](https://img.shields.io/npm/v/opencode-orchestrator.svg)](https://www.npmjs.com/package/opencode-orchestrator)
[![Tests](https://img.shields.io/badge/tests-211%20passed-brightgreen.svg)]()

---

## ğŸš€ What's New in v0.6.0

**Ultimate Agent Architecture** - Production-ready distributed agent orchestration!

| Feature | Description |
|---------|-------------|
| **â™¾ï¸ Unlimited Mode** | No step limits - runs until mission complete |
| **ğŸ§  Anti-Hallucination** | Research before coding, verify with docs |
| **âš¡ 50x Parallel Sessions** | Massive concurrent task execution |
| **ğŸ“Š Auto Memory Management** | GC, archiving, zero memory leaks |
| **ğŸ”„ Auto Recovery** | Handles rate limits, errors automatically |
| **ğŸ“¡ Event-Driven** | Real-time pub/sub across all components |

---

## ğŸ›ï¸ System Architecture

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                                                                                                        â”‚
â”‚                                         USER REQUEST                                                   â”‚
â”‚                                    (OpenCode Terminal / UI)                                            â”‚
â”‚                                              â”‚                                                         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                               â”‚
                                               â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                                                                                                        â”‚
â”‚                              ORCHESTRATOR PLUGIN  (src/index.ts)                                       â”‚
â”‚                                                                                                        â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚   Session State     â”‚  â”‚   Agent Definitions â”‚  â”‚   Tools Registry    â”‚  â”‚   Toast.enable      â”‚   â”‚
â”‚  â”‚   Map<sessionId,    â”‚  â”‚   (7 agents)        â”‚  â”‚   (15+ tools)       â”‚  â”‚   AutoToasts()      â”‚   â”‚
â”‚  â”‚   {step, maxSteps,  â”‚  â”‚                     â”‚  â”‚                     â”‚  â”‚   â†’ EventBus sub    â”‚   â”‚
â”‚  â”‚    timestamp}>      â”‚  â”‚   â€¢ Commander ğŸ¯    â”‚  â”‚   â€¢ call_agent      â”‚  â”‚                     â”‚   â”‚
â”‚  â”‚                     â”‚  â”‚   â€¢ Architect ğŸ—ï¸   â”‚  â”‚   â€¢ launch_parallel â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚  â”‚   Cleanup:          â”‚  â”‚   â€¢ Builder ğŸ”¨     â”‚  â”‚   â€¢ check_parallel  â”‚                            â”‚
â”‚  â”‚   session.deleted   â”‚  â”‚   â€¢ Inspector ğŸ”   â”‚  â”‚   â€¢ webfetch        â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚   â†’ sessions.delete â”‚  â”‚   â€¢ Recorder ğŸ’¾    â”‚  â”‚   â€¢ websearch       â”‚  â”‚ ProgressTracker     â”‚   â”‚
â”‚  â”‚   â†’ Progress.clear  â”‚  â”‚   â€¢ Librarian ğŸ“š   â”‚  â”‚   â€¢ grep_search     â”‚  â”‚   .startSession()   â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚   â€¢ Researcher ğŸ”¬  â”‚  â”‚   â€¢ run_background  â”‚  â”‚   .recordSnapshot() â”‚   â”‚
â”‚                           â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚   .clearSession()   â”‚   â”‚
â”‚                                                                              â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                               â”‚                                                        â”‚
â”‚                                               â–¼                                                        â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚                                                                                                  â”‚  â”‚
â”‚  â”‚                               PARENT SESSION (Main Execution Loop)                              â”‚  â”‚
â”‚  â”‚                                                                                                  â”‚  â”‚
â”‚  â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚  â”‚
â”‚  â”‚   â”‚  Commander  â”‚â”€â”€â”€â–¶â”‚  Architect  â”‚â”€â”€â”€â–¶â”‚   Builder   â”‚â”€â”€â”€â–¶â”‚  Inspector  â”‚â”€â”€â”€â–¶â”‚  Recorder   â”‚  â”‚  â”‚
â”‚  â”‚   â”‚     ğŸ¯      â”‚    â”‚     ğŸ—ï¸     â”‚    â”‚     ğŸ”¨      â”‚    â”‚     ğŸ”      â”‚    â”‚     ğŸ’¾      â”‚  â”‚  â”‚
â”‚  â”‚   â”‚             â”‚    â”‚             â”‚    â”‚             â”‚    â”‚             â”‚    â”‚             â”‚  â”‚  â”‚
â”‚  â”‚   â”‚ Orchestrate â”‚    â”‚ Decompose   â”‚    â”‚ Implement   â”‚    â”‚ Audit &     â”‚    â”‚ Save        â”‚  â”‚  â”‚
â”‚  â”‚   â”‚ & delegate  â”‚    â”‚ into tasks  â”‚    â”‚ code        â”‚    â”‚ verify      â”‚    â”‚ context     â”‚  â”‚  â”‚
â”‚  â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚  â”‚
â”‚  â”‚                                                â”‚                                                â”‚  â”‚
â”‚  â”‚                                                â”‚ launch_parallel_agent()                        â”‚  â”‚
â”‚  â”‚                                                â–¼                                                â”‚  â”‚
â”‚  â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚  â”‚
â”‚  â”‚   â”‚                                                                                           â”‚ â”‚  â”‚
â”‚  â”‚   â”‚    hooks: "chat.message" / "tool.execute.after" / "handler"                               â”‚ â”‚  â”‚
â”‚  â”‚   â”‚                                                                                           â”‚ â”‚  â”‚
â”‚  â”‚   â”‚    chat.message:                                                                          â”‚ â”‚  â”‚
â”‚  â”‚   â”‚      â€¢ Parse /task, /plan slash commands                                                  â”‚ â”‚  â”‚
â”‚  â”‚   â”‚      â€¢ Auto-start session on Commander agent selection                                    â”‚ â”‚  â”‚
â”‚  â”‚   â”‚      â€¢ emit(TASK_EVENTS.STARTED, { taskId, agent })                                       â”‚ â”‚  â”‚
â”‚  â”‚   â”‚                                                                                           â”‚ â”‚  â”‚
â”‚  â”‚   â”‚    tool.execute.after:                                                                    â”‚ â”‚  â”‚
â”‚  â”‚   â”‚      â€¢ Check "MISSION COMPLETE" â†’ emit(MISSION_EVENTS.COMPLETE)                           â”‚ â”‚  â”‚
â”‚  â”‚   â”‚      â€¢ Check "/stop" or "/cancel" â†’ emit(TASK_EVENTS.FAILED)                              â”‚ â”‚  â”‚
â”‚  â”‚   â”‚      â€¢ Record ProgressTracker.recordSnapshot()                                             â”‚ â”‚  â”‚
â”‚  â”‚   â”‚      â€¢ Inject CONTINUE_INSTRUCTION â†’ client.session.prompt()                              â”‚ â”‚  â”‚
â”‚  â”‚   â”‚                                                                                           â”‚ â”‚  â”‚
â”‚  â”‚   â”‚    handler (event):                                                                       â”‚ â”‚  â”‚
â”‚  â”‚   â”‚      â€¢ session.deleted â†’ cleanup sessions, state, ProgressTracker                         â”‚ â”‚  â”‚
â”‚  â”‚   â”‚      â€¢ Pass to ParallelAgentManager.handleEvent()                                         â”‚ â”‚  â”‚
â”‚  â”‚   â”‚                                                                                           â”‚ â”‚  â”‚
â”‚  â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚  â”‚
â”‚  â”‚                                                                                                  â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                                                                                                        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                                     â”‚
                                                     â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                                                                                                        â”‚
â”‚                            PARALLEL AGENT MANAGER  (src/core/agents/manager.ts)                        â”‚
â”‚                                                                                                        â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚   â”‚                                   Component Composition                                         â”‚  â”‚
â”‚   â”‚                                                                                                 â”‚  â”‚
â”‚   â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”      â”‚  â”‚
â”‚   â”‚   â”‚    TaskLauncher       â”‚      â”‚    TaskResumer        â”‚      â”‚    TaskPoller         â”‚      â”‚  â”‚
â”‚   â”‚   â”‚  (task-launcher.ts)   â”‚      â”‚  (task-resumer.ts)    â”‚      â”‚  (task-poller.ts)     â”‚      â”‚  â”‚
â”‚   â”‚   â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€    â”‚      â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€    â”‚      â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€    â”‚      â”‚  â”‚
â”‚   â”‚   â”‚                       â”‚      â”‚                       â”‚      â”‚                       â”‚      â”‚  â”‚
â”‚   â”‚   â”‚  async launch():      â”‚      â”‚  async resume():      â”‚      â”‚  poll() every 1s:     â”‚      â”‚  â”‚
â”‚   â”‚   â”‚    1. await acquire() â”‚      â”‚    1. Find task       â”‚      â”‚    1. Get running     â”‚      â”‚  â”‚
â”‚   â”‚   â”‚    2. session.create()â”‚      â”‚    2. session.message â”‚      â”‚    2. Check events    â”‚      â”‚  â”‚
â”‚   â”‚   â”‚    3. store.set()     â”‚      â”‚    3. Notify parent   â”‚      â”‚    3. If idle+stable  â”‚      â”‚  â”‚
â”‚   â”‚   â”‚    4. emit(STARTED)   â”‚      â”‚                       â”‚      â”‚       â†’ completed     â”‚      â”‚  â”‚
â”‚   â”‚   â”‚    5. session.message â”‚      â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜      â”‚    4. emit(COMPLETED) â”‚      â”‚  â”‚
â”‚   â”‚   â”‚    6. Start poller    â”‚                                     â”‚    5. scheduleCleanup â”‚      â”‚  â”‚
â”‚   â”‚   â”‚                       â”‚                                     â”‚                       â”‚      â”‚  â”‚
â”‚   â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                                     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜      â”‚  â”‚
â”‚   â”‚               â”‚                                                             â”‚                  â”‚  â”‚
â”‚   â”‚               â–¼                                                             â–¼                  â”‚  â”‚
â”‚   â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”      â”‚  â”‚
â”‚   â”‚   â”‚    TaskCleaner        â”‚      â”‚    EventHandler       â”‚      â”‚ ConcurrencyController â”‚      â”‚  â”‚
â”‚   â”‚   â”‚  (task-cleaner.ts)    â”‚      â”‚  (event-handler.ts)   â”‚      â”‚  (concurrency.ts)     â”‚      â”‚  â”‚
â”‚   â”‚   â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€    â”‚      â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€    â”‚      â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€    â”‚      â”‚  â”‚
â”‚   â”‚   â”‚                       â”‚      â”‚                       â”‚      â”‚                       â”‚      â”‚  â”‚
â”‚   â”‚   â”‚  pruneExpiredTasks(): â”‚      â”‚  handle(event):       â”‚      â”‚  acquire(key):        â”‚      â”‚  â”‚
â”‚   â”‚   â”‚    â€¢ TTL > 60min      â”‚      â”‚                       â”‚      â”‚    â€¢ limit = 10       â”‚      â”‚  â”‚
â”‚   â”‚   â”‚    â†’ status=timeout   â”‚      â”‚    session.idle:      â”‚      â”‚    â€¢ if < limit       â”‚      â”‚  â”‚
â”‚   â”‚   â”‚    â†’ release()        â”‚      â”‚      â€¢ MIN_STABILITY  â”‚      â”‚      â†’ immediate      â”‚      â”‚  â”‚
â”‚   â”‚   â”‚    â†’ session.delete() â”‚      â”‚      â€¢ validateOutput â”‚      â”‚    â€¢ else queue.push  â”‚      â”‚  â”‚
â”‚   â”‚   â”‚                       â”‚      â”‚      â†’ completed      â”‚      â”‚                       â”‚      â”‚  â”‚
â”‚   â”‚   â”‚  scheduleCleanup():   â”‚      â”‚      â†’ release()      â”‚      â”‚  release(key):        â”‚      â”‚  â”‚
â”‚   â”‚   â”‚    â€¢ setTimeout 10min â”‚      â”‚      â†’ scheduleClean  â”‚      â”‚    â€¢ if queue.length  â”‚      â”‚  â”‚
â”‚   â”‚   â”‚    â†’ session.delete() â”‚      â”‚                       â”‚      â”‚      â†’ queue.shift()  â”‚      â”‚  â”‚
â”‚   â”‚   â”‚    â†’ store.delete()   â”‚      â”‚    session.deleted:   â”‚      â”‚      â†’ next()         â”‚      â”‚  â”‚
â”‚   â”‚   â”‚                       â”‚      â”‚      â†’ release()      â”‚      â”‚    â€¢ else count--     â”‚      â”‚  â”‚
â”‚   â”‚   â”‚  notifyParent():      â”‚      â”‚      â†’ store.delete() â”‚      â”‚                       â”‚      â”‚  â”‚
â”‚   â”‚   â”‚    â†’ session.prompt() â”‚      â”‚                       â”‚      â”‚  getLimit(key):       â”‚      â”‚  â”‚
â”‚   â”‚   â”‚                       â”‚      â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜      â”‚    â€¢ MAX_TOTAL = 50   â”‚      â”‚  â”‚
â”‚   â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                                     â”‚    â€¢ PER_AGENT = 10   â”‚      â”‚  â”‚
â”‚   â”‚                                                                 â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜      â”‚  â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                                                     â”‚                                                  â”‚
â”‚                                                     â–¼                                                  â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚   â”‚                                                                                                 â”‚  â”‚
â”‚   â”‚                              TaskStore  (task-store.ts)                                         â”‚  â”‚
â”‚   â”‚                                                                                                 â”‚  â”‚
â”‚   â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”        â”‚  â”‚
â”‚   â”‚   â”‚   tasks: Map<id, Task>  â”‚  â”‚ pendingByParent: Map    â”‚  â”‚ notifications: Map      â”‚        â”‚  â”‚
â”‚   â”‚   â”‚   MAX: 1000             â”‚  â”‚ <parentId, Set<taskId>> â”‚  â”‚ <parentId, Task[]>      â”‚        â”‚  â”‚
â”‚   â”‚   â”‚                         â”‚  â”‚                         â”‚  â”‚ MAX: 100/parent         â”‚        â”‚  â”‚
â”‚   â”‚   â”‚   set() â†’ auto gc()     â”‚  â”‚ trackPending()          â”‚  â”‚                         â”‚        â”‚  â”‚
â”‚   â”‚   â”‚   getRunning()          â”‚  â”‚ untrackPending()        â”‚  â”‚ queueNotification()     â”‚        â”‚  â”‚
â”‚   â”‚   â”‚   getByParent()         â”‚  â”‚ hasPending()            â”‚  â”‚ â†’ FIFO eviction         â”‚        â”‚  â”‚
â”‚   â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜        â”‚  â”‚
â”‚   â”‚                                                                                                 â”‚  â”‚
â”‚   â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚  â”‚
â”‚   â”‚   â”‚                                                                                          â”‚  â”‚  â”‚
â”‚   â”‚   â”‚   async gc():                                                                            â”‚  â”‚  â”‚
â”‚   â”‚   â”‚     â€¢ completed > 30min â†’ archiveTasks() â†’ .cache/task-archive/tasks_YYYY-MM-DD.jsonl   â”‚  â”‚  â”‚
â”‚   â”‚   â”‚     â€¢ error/cancelled > 10min â†’ delete                                                  â”‚  â”‚  â”‚
â”‚   â”‚   â”‚                                                                                          â”‚  â”‚  â”‚
â”‚   â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚  â”‚
â”‚   â”‚                                                                                                 â”‚  â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                                                     â”‚                                                  â”‚
â”‚                                                     â–¼                                                  â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚   â”‚                                                                                                 â”‚  â”‚
â”‚   â”‚                           CHILD SESSIONS POOL  (up to 50 concurrent)                            â”‚  â”‚
â”‚   â”‚                                                                                                 â”‚  â”‚
â”‚   â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚  â”‚
â”‚   â”‚   â”‚Session 1 â”‚ â”‚Session 2 â”‚ â”‚Session 3 â”‚ â”‚Session 4 â”‚ â”‚Session 5 â”‚ â”‚Session 6 â”‚ â”‚ ... 50   â”‚  â”‚  â”‚
â”‚   â”‚   â”‚ Builder  â”‚ â”‚Librarian â”‚ â”‚Researcherâ”‚ â”‚Inspector â”‚ â”‚ Builder  â”‚ â”‚ Builder  â”‚ â”‚          â”‚  â”‚  â”‚
â”‚   â”‚   â”‚   ğŸ”¨     â”‚ â”‚   ğŸ“š     â”‚ â”‚   ğŸ”¬     â”‚ â”‚   ğŸ”     â”‚ â”‚   ğŸ”¨     â”‚ â”‚   ğŸ”¨     â”‚ â”‚          â”‚  â”‚  â”‚
â”‚   â”‚   â”‚          â”‚ â”‚          â”‚ â”‚          â”‚ â”‚          â”‚ â”‚          â”‚ â”‚          â”‚ â”‚          â”‚  â”‚  â”‚
â”‚   â”‚   â”‚ running  â”‚ â”‚ running  â”‚ â”‚completed â”‚ â”‚ running  â”‚ â”‚ error    â”‚ â”‚ pending  â”‚ â”‚          â”‚  â”‚  â”‚
â”‚   â”‚   â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚  â”‚
â”‚   â”‚        â”‚            â”‚            â”‚            â”‚            â”‚            â”‚                      â”‚  â”‚
â”‚   â”‚        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                      â”‚  â”‚
â”‚   â”‚                                         â”‚                                                       â”‚  â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                                             â”‚                                                          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                              â”‚
                                              â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                                                                                                        â”‚
â”‚                                    EVENT BUS  (src/core/bus/)                                          â”‚
â”‚                                                                                                        â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚   â”‚                                                                                                 â”‚  â”‚
â”‚   â”‚                                    Event Types (Pub/Sub)                                        â”‚  â”‚
â”‚   â”‚                                                                                                 â”‚  â”‚
â”‚   â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚  â”‚
â”‚   â”‚   â”‚task.started â”‚  â”‚task.completedâ”‚ â”‚ task.failed â”‚  â”‚session.idle â”‚  â”‚ mission.complete    â”‚  â”‚  â”‚
â”‚   â”‚   â”‚             â”‚  â”‚             â”‚  â”‚             â”‚  â”‚session.deleteâ”‚ â”‚ mission.all_completeâ”‚  â”‚  â”‚
â”‚   â”‚   â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚  â”‚
â”‚   â”‚          â”‚                â”‚                â”‚                â”‚                    â”‚             â”‚  â”‚
â”‚   â”‚          â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜             â”‚  â”‚
â”‚   â”‚                                            â”‚                                                    â”‚  â”‚
â”‚   â”‚                                            â–¼                                                    â”‚  â”‚
â”‚   â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚  â”‚
â”‚   â”‚   â”‚                                    Subscribers                                           â”‚  â”‚  â”‚
â”‚   â”‚   â”‚                                                                                          â”‚  â”‚  â”‚
â”‚   â”‚   â”‚   Toast.enableAutoToasts():           EventHandler.handle():                             â”‚  â”‚  â”‚
â”‚   â”‚   â”‚     â€¢ task.started â†’ presets.taskStarted()      â€¢ release concurrency                    â”‚  â”‚  â”‚
â”‚   â”‚   â”‚     â€¢ task.completed â†’ presets.taskCompleted()  â€¢ cleanup resources                      â”‚  â”‚  â”‚
â”‚   â”‚   â”‚     â€¢ task.failed â†’ presets.taskFailed()                                                â”‚  â”‚  â”‚
â”‚   â”‚   â”‚     â€¢ mission.complete â†’ presets.missionComplete()                                      â”‚  â”‚  â”‚
â”‚   â”‚   â”‚     â€¢ document.cached â†’ presets.documentCached()                                        â”‚  â”‚  â”‚
â”‚   â”‚   â”‚                                                                                          â”‚  â”‚  â”‚
â”‚   â”‚   â”‚   Returns: () => void (unsubscribe function for cleanup)                                â”‚  â”‚  â”‚
â”‚   â”‚   â”‚                                                                                          â”‚  â”‚  â”‚
â”‚   â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚  â”‚
â”‚   â”‚                                                                                                 â”‚  â”‚
â”‚   â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚  â”‚
â”‚   â”‚   â”‚   EventBusImpl:                                                                          â”‚  â”‚  â”‚
â”‚   â”‚   â”‚     â€¢ subscribe(type, handler) â†’ unsubscribe fn                                         â”‚  â”‚  â”‚
â”‚   â”‚   â”‚     â€¢ publish(type, properties) â†’ Event                                                 â”‚  â”‚  â”‚
â”‚   â”‚   â”‚     â€¢ emit(type, properties) â†’ void                                                     â”‚  â”‚  â”‚
â”‚   â”‚   â”‚     â€¢ once(type, handler) â†’ unsubscribe fn                                              â”‚  â”‚  â”‚
â”‚   â”‚   â”‚     â€¢ waitFor(type, timeout) â†’ Promise<Event>                                           â”‚  â”‚  â”‚
â”‚   â”‚   â”‚     â€¢ history: Event[] (max 100, FIFO)                                                  â”‚  â”‚  â”‚
â”‚   â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚  â”‚
â”‚   â”‚                                                                                                 â”‚  â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                                                                                                        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                                     â”‚
                                                     â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                                                                                                        â”‚
â”‚                                        CORE SYSTEMS LAYER                                              â”‚
â”‚                                                                                                        â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”            â”‚
â”‚   â”‚   Progress Tracker       â”‚  â”‚   Auto Recovery          â”‚  â”‚   Document Cache         â”‚            â”‚
â”‚   â”‚   (src/core/progress/)   â”‚  â”‚   (src/core/recovery/)   â”‚  â”‚   (src/core/cache/)      â”‚            â”‚
â”‚   â”‚   â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€     â”‚  â”‚   â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€     â”‚  â”‚   â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€     â”‚            â”‚
â”‚   â”‚                          â”‚  â”‚                          â”‚  â”‚                          â”‚            â”‚
â”‚   â”‚   startSession(id)       â”‚  â”‚   handleError(context)   â”‚  â”‚   get(filename)          â”‚            â”‚
â”‚   â”‚   recordSnapshot(id, {   â”‚  â”‚     â†’ match patterns     â”‚  â”‚   set(filename, content) â”‚            â”‚
â”‚   â”‚     currentStep,         â”‚  â”‚     â†’ return action      â”‚  â”‚   list()                 â”‚            â”‚
â”‚   â”‚     maxSteps             â”‚  â”‚                          â”‚  â”‚   clear(filename)        â”‚            â”‚
â”‚   â”‚   })                     â”‚  â”‚   Patterns:              â”‚  â”‚   cleanExpired()         â”‚            â”‚
â”‚   â”‚   formatCompact(id)      â”‚  â”‚     â€¢ rate_limit         â”‚  â”‚                          â”‚            â”‚
â”‚   â”‚   clearSession(id)       â”‚  â”‚       â†’ retry+backoff    â”‚  â”‚   Storage:               â”‚            â”‚
â”‚   â”‚                          â”‚  â”‚     â€¢ context_overflow   â”‚  â”‚   .cache/docs/*.md       â”‚            â”‚
â”‚   â”‚   Store:                 â”‚  â”‚       â†’ compact          â”‚  â”‚                          â”‚            â”‚
â”‚   â”‚   sessions: Map<id,      â”‚  â”‚     â€¢ network            â”‚  â”‚                          â”‚            â”‚
â”‚   â”‚     ProgressSnapshot[]>  â”‚  â”‚       â†’ retry 3x         â”‚  â”‚                          â”‚            â”‚
â”‚   â”‚   max 100/session        â”‚  â”‚     â€¢ parse_error        â”‚  â”‚                          â”‚            â”‚
â”‚   â”‚                          â”‚  â”‚       â†’ skip             â”‚  â”‚                          â”‚            â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜            â”‚
â”‚                                                                                                        â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”            â”‚
â”‚   â”‚   Toast Notifier         â”‚  â”‚   Async Queue            â”‚  â”‚   Background Commands    â”‚            â”‚
â”‚   â”‚   (src/core/notification)â”‚  â”‚   (src/core/queue/)      â”‚  â”‚   (src/core/commands/)   â”‚            â”‚
â”‚   â”‚   â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€     â”‚  â”‚   â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€     â”‚  â”‚   â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€     â”‚            â”‚
â”‚   â”‚                          â”‚  â”‚                          â”‚  â”‚                          â”‚            â”‚
â”‚   â”‚   show({ title, msg })   â”‚  â”‚   workPool(items, fn,    â”‚  â”‚   runBackground(cmd)     â”‚            â”‚
â”‚   â”‚                          â”‚  â”‚     concurrency)         â”‚  â”‚   checkBackground(id)    â”‚            â”‚
â”‚   â”‚   presets:               â”‚  â”‚   workPoolWithResults()  â”‚  â”‚   listBackground()       â”‚            â”‚
â”‚   â”‚     â€¢ taskStarted()      â”‚  â”‚   processBatches()       â”‚  â”‚   killBackground(id)     â”‚            â”‚
â”‚   â”‚     â€¢ taskCompleted()    â”‚  â”‚                          â”‚  â”‚                          â”‚            â”‚
â”‚   â”‚     â€¢ taskFailed()       â”‚  â”‚   retryWithBackoff(fn,   â”‚  â”‚   Storage:               â”‚            â”‚
â”‚   â”‚     â€¢ missionComplete()  â”‚  â”‚     maxRetries, delay)   â”‚  â”‚   backgroundJobs: Map    â”‚            â”‚
â”‚   â”‚     â€¢ documentCached()   â”‚  â”‚   withTimeout(fn, ms)    â”‚  â”‚   <id, BackgroundTask>   â”‚            â”‚
â”‚   â”‚                          â”‚  â”‚   debounceAsync(fn, ms)  â”‚  â”‚                          â”‚            â”‚
â”‚   â”‚   enableAutoToasts()     â”‚  â”‚                          â”‚  â”‚                          â”‚            â”‚
â”‚   â”‚   â†’ EventBus.subscribe() â”‚  â”‚   AsyncQueue<T>:         â”‚  â”‚                          â”‚            â”‚
â”‚   â”‚   â†’ returns disable fn   â”‚  â”‚     async iterator       â”‚  â”‚                          â”‚            â”‚
â”‚   â”‚                          â”‚  â”‚                          â”‚  â”‚                          â”‚            â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜            â”‚
â”‚                                                                                                        â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”            â”‚
â”‚   â”‚   Shared Context         â”‚  â”‚   Task Decomposer        â”‚  â”‚   Todo Enforcer          â”‚            â”‚
â”‚   â”‚   (src/core/session/)    â”‚  â”‚   (src/core/task/)       â”‚  â”‚   (src/core/loop/)       â”‚            â”‚
â”‚   â”‚   â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€     â”‚  â”‚   â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€     â”‚  â”‚   â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€     â”‚            â”‚
â”‚   â”‚                          â”‚  â”‚                          â”‚  â”‚                          â”‚            â”‚
â”‚   â”‚   create(id, parentId)   â”‚  â”‚   create(id, objective)  â”‚  â”‚   parseTodos(data)       â”‚            â”‚
â”‚   â”‚   get(id)                â”‚  â”‚   addTask(id, {          â”‚  â”‚   getIncompleteCount()   â”‚            â”‚
â”‚   â”‚   getMerged(id)          â”‚  â”‚     description,         â”‚  â”‚   hasRemainingWork()     â”‚            â”‚
â”‚   â”‚   â†’ includes parent ctx  â”‚  â”‚     level: 1|2|3,        â”‚  â”‚   getNextPending()       â”‚            â”‚
â”‚   â”‚                          â”‚  â”‚     parallelGroup?,      â”‚  â”‚   getStats()             â”‚            â”‚
â”‚   â”‚   addDocument(id, doc)   â”‚  â”‚     dependsOn?           â”‚  â”‚   formatProgress()       â”‚            â”‚
â”‚   â”‚   addFinding(id, find)   â”‚  â”‚   })                     â”‚  â”‚   isMissionComplete()    â”‚            â”‚
â”‚   â”‚   addDecision(id, dec)   â”‚  â”‚   updateStatus(id, task) â”‚  â”‚                          â”‚            â”‚
â”‚   â”‚                          â”‚  â”‚   getNextTasks(id)       â”‚  â”‚   generateContinuation   â”‚            â”‚
â”‚   â”‚   delete(id)             â”‚  â”‚   getParallelBatch(id)   â”‚  â”‚     Prompt()             â”‚            â”‚
â”‚   â”‚   getStats(id)           â”‚  â”‚   getSummary(id)         â”‚  â”‚   generateCompletion     â”‚            â”‚
â”‚   â”‚                          â”‚  â”‚                          â”‚  â”‚     Message()            â”‚            â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜            â”‚
â”‚                                                                                                        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ¯ Key Differentiators

| Capability | OpenCode Orchestrator | Basic Plugins |
|------------|----------------------|---------------|
| **Parallel Sessions** | Up to 50 concurrent | Single session |
| **Memory Management** | Auto GC + disk archiving | Memory leaks |
| **Error Recovery** | Pattern-based auto retry | Crash |
| **Context Sharing** | Parent-child merge | Isolated |
| **Event System** | Real-time pub/sub | None |
| **Task Decomposition** | 3-level hierarchy | Flat |

---

## Installation

```bash
npm install -g opencode-orchestrator
```

Restart OpenCode after installation.

---

## Usage

### ğŸš€ Select Commander via Tab Key (Recommended)

Press `Tab` in OpenCode â†’ Select **Commander** â†’ Type your mission!

<div align="center">
  <img src="assets/tui_image.png" alt="Commander TUI" width="600" />
  <p><sub><b>Commander</b> agent selection interface in OpenCode (TUI)</sub></p>

  <br/> <img src="assets/window_image.png" alt="Commander Windows" width="600" />
  <p><sub>Execution of <b>Commander</b> agent on Windows environment</sub></p>
</div>

```
"Fix the login bug in the docker-compose environment"
```

### ğŸ“‹ Use /task Command

```bash
/task "Implement user authentication with JWT"
```

> **ğŸ’¡ Tip:** Both regular messages and `/task` now run in **unlimited mode** by default!

---

## The 7 Agents

| Agent            | Role         | Responsibility                     |
| :--------------- | :----------- | :--------------------------------- |
| **Commander** ğŸ¯ | Orchestrator | Autonomous mission control         |
| **Architect** ğŸ—ï¸ | Planner      | Hierarchical task decomposition    |
| **Builder** ğŸ”¨   | Developer    | Full-stack implementation          |
| **Inspector** ğŸ” | Quality      | Audit, auto-fix & doc verification |
| **Recorder** ğŸ’¾  | Context      | Progress tracking                  |
| **Librarian** ğŸ“š | Research     | Documentation & API research       |
| **Researcher** ğŸ”¬ | Investigation | Pre-task research & analysis      |

---

## ğŸ› ï¸ Available Tools

| Tool | Description |
|------|-------------|
| `call_agent` | Call another agent synchronously |
| `launch_parallel_agent` | Start parallel async session |
| `check_parallel_task` | Check task status |
| `collect_parallel_results` | Gather completed results |
| `webfetch` | Fetch URL content as Markdown |
| `websearch` | Search web (SearXNG â†’ Brave â†’ DuckDuckGo) |
| `codesearch` | Search open source code patterns |
| `cache_docs` | Manage cached documentation |
| `run_background` | Run command in background |
| `grep_search` / `glob_search` | Fast file search |

---

## ğŸ“Š Resource Guarantees

| Resource | Limit | Safety Mechanism |
|----------|-------|------------------|
| Parallel Sessions | 50 | Queue overflow protection |
| Tasks in Memory | 1,000 | Auto GC + disk archive |
| Notifications | 100/parent | FIFO eviction |
| Event History | 100 | Ring buffer |
| Session TTL | 60 min | Auto cleanup |
| Poll Interval | 1 second | Fast completion detection |

---

## ğŸ§ª Test Coverage

```
Test Files:  18 passed
Tests:       211 passed
Duration:    ~4.3s
```

---

## Uninstall

```bash
npm uninstall -g opencode-orchestrator
```

---

## Documentation

- **[System Architecture](docs/SYSTEM_ARCHITECTURE.md)** â€” Detailed technical docs
- **[OpenCode SDK Reference](docs/OPENCODE_SDK_REFERENCE.md)** â€” API usage reference
- [Release Notes](docs/releases/) â€” Version history
- [Troubleshooting](docs/PLUGIN_TROUBLESHOOTING.md)

---

## License

MIT License. [LICENSE](LICENSE)

---

<div align="center">
  <b>Enterprise-scale. Memory-safe. Self-healing. Unlimited.</b>
</div>
